<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>–•–æ–º—è–∫ –¢–∞–ø–∞–ª–∫–∞ (Telegram Web App)</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<style>
  body {
    margin: 0; font-family: "Comic Sans MS", cursive, sans-serif; user-select: none;
    background: linear-gradient(135deg, #ffecd2, #fcb69f);
    color: #000;
    display: flex; justify-content: center; align-items: center; height: 100vh;
  }
  .game {
    background: #fff; border-radius: 20px; padding: 20px;
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    text-align: center; width: 300px;
  }
  .b { font-size: 2em; margin-bottom: 10px; color: #ff7f50; }
  .e { font-size: 1.2em; margin-bottom: 5px; color: #00bfff; }
  .eb-c {
    background: #ddd; border-radius: 10px; overflow: hidden; height: 20px; margin-bottom: 20px;
  }
  .eb {
    height: 100%; background: linear-gradient(90deg, #00bfff, #1e90ff);
    width: 100%; transition: width 0.1s linear;
  }
  .h {
    width: 150px; cursor: pointer; user-select: none;
    transition: transform 0.1s ease;
  }
  .h:active {
    transform: scale(1.1) rotate(5deg);
  }
  button.r {
    margin-top: 10px; background: #ff7f50; color: #fff; border: none;
    padding: 10px 20px; border-radius: 10px; cursor: pointer;
    font-size: 1em; user-select: none;
  }
  button.r:hover {
    background: #ff6347;
  }
</style>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
<div class="game">
  <div class="b">–ë–∞–ª–∞–Ω—Å: <span id="b">0</span></div>
  <div class="e">–≠–Ω–µ—Ä–≥–∏—è: <span id="e">1000</span>/1000</div>
  <div class="eb-c"><div class="eb" id="eb"></div></div>
  <img src="https://www.online.ua/static/content/files/5/41/0d6fb9417841fb680f85f8fd2b819415.jpg" alt="–•–æ–º—è–∫" class="h" id="h" />
  <br />
  <button class="r" id="resetBtn">–°–±—Ä–æ—Å–∏—Ç—å</button>
</div>

<script>
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
  const tg = window.Telegram.WebApp;
  tg.expand(); // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –æ–∫–Ω–æ –Ω–∞ –º–∞–∫—Å–∏–º—É–º

  const balanceElem = document.getElementById('b');
  const energyElem = document.getElementById('e');
  const energyBarElem = document.getElementById('eb');
  const hamsterElem = document.getElementById('h');
  const resetBtn = document.getElementById('resetBtn');

  let balance = 0;
  let energy = 1000;
  const maxEnergy = 1000;
  const energyRestoreSpeed = 0.5;

  function loadData() {
    try {
      const storedBalance = localStorage.getItem('hamsterBalance');
      const storedEnergy = localStorage.getItem('hamsterEnergy');
      if (storedBalance !== null) balance = parseInt(storedBalance) || 0;
      if (storedEnergy !== null) energy = parseFloat(storedEnergy) || maxEnergy;
    } catch {
      balance = 0;
      energy = maxEnergy;
    }
  }

  function saveData() {
    localStorage.setItem('hamsterBalance', balance);
    localStorage.setItem('hamsterEnergy', energy);
  }

  function updateUI() {
    balanceElem.textContent = balance;
    energyElem.textContent = Math.floor(energy);
    energyBarElem.style.width = (energy / maxEnergy) * 100 + '%';

    if (energy <= 0) {
      hamsterElem.classList.add('disabled');
      hamsterElem.style.pointerEvents = 'none';
    } else {
      hamsterElem.classList.remove('disabled');
      hamsterElem.style.pointerEvents = 'auto';
    }
  }

  function restoreEnergy() {
    if (energy < maxEnergy) {
      energy = Math.min(energy + energyRestoreSpeed, maxEnergy);
      updateUI();
      saveData();
    }
  }

  hamsterElem.addEventListener('click', () => {
    if (energy >= 1) {
      balance++;
      energy--;
      updateUI();
      saveData();

      hamsterElem.classList.add('a');
      setTimeout(() => hamsterElem.classList.remove('a'), 300);

      // –ü—Ä–∏–º–µ—Ä –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Telegram: –æ–±–Ω–æ–≤–∏–º –∫–Ω–æ–ø–∫—É –≤–Ω–∏–∑—É
      tg.MainButton.setText(`–ë–∞–ª–∞–Ω—Å: ${balance} üêπ`);
      tg.MainButton.show();
    }
  });

  resetBtn.addEventListener('click', () => {
    if(confirm("–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å?")) {
      balance = 0;
      energy = maxEnergy;
      updateUI();
      saveData();

      tg.MainButton.setText("–ù–∞—á–∞—Ç—å –∏–≥—Ä—É");
      tg.MainButton.show();
    }
  });

  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ –∏ —Å–∫—Ä—ã—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ Telegram –µ—Å–ª–∏ —ç–Ω–µ—Ä–≥–∏—è 0
  setInterval(() => {
    restoreEnergy();
    if (energy <= 0) tg.MainButton.hide();
  }, 1000);

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  loadData();
  updateUI();

  // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ Telegram
  tg.MainButton.setText("–ù–∞—á–∞—Ç—å –∏–≥—Ä—É");
  tg.MainButton.show();

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–µ Telegram
  tg.MainButton.onClick(() => {
    alert("–≠—Ç–æ –∫–Ω–æ–ø–∫–∞ Telegram WebApp. –¢—ã –º–æ–∂–µ—à—å —Ç—É—Ç —Å–¥–µ–ª–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–ª–∏ —á—Ç–æ-—Ç–æ –µ—â—ë.");
  });

</script>
</body>
</html>
